local HITBOX_SIZE = Vector3.new(50, 50, 50)
local HITBOX_OFFSET = CFrame.new(0, 0, -25)
local HITBOX_DURATION = 0.15

local event = game.ReplicatedStorage:WaitForChild("HitboxEvent")

event.OnServerEvent:Connect(function(player)
    local character = player.Character
    if not character then return end

    local root = character:FindFirstChild("HumanoidRootPart")
    if not root then return end

    local alreadyHit = {}

    local startTime = tick()

    while tick() - startTime < HITBOX_DURATION do
        local boxCFrame = root.CFrame * HITBOX_OFFSET

        local parts = workspace:GetPartBoundsInBox(
            boxCFrame,
            HITBOX_SIZE
        )

        for _, part in pairs(parts) do
            local model = part:FindFirstAncestorOfClass("Model")
            local humanoid = model and model:FindFirstChildOfClass("Humanoid")

            if humanoid and model ~= character then
                if not alreadyHit[model] then
                    alreadyHit[model] = true
                    humanoid:TakeDamage(DAMAGE)
                end
            end
        end

        task.wait()
    end
end)